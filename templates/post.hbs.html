{{#extend "layout"}}

  {{#content "meta"}}
  <meta property="og:title" content="{{title}}{{#if subtitle}}, {{subtitle}}{{/if}}">
  <meta property="og:description" content="{{description}}">
  <meta property="og:image" content="https://curvyandtrans.com{{rev titlecard}}">
  <meta property="og:url" content="https://curvyandtrans.com{{url}}">
  <meta name="twitter:title" content="{{title}}{{#if subtitle}}, {{subtitle}}{{/if}}">
  <meta name="twitter:description" content="{{description}}">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://curvyandtrans.com{{rev titlecard}}">
  <link rel="canonical" href="https://curvyandtrans.com{{url}}">{{/content}}

  {{#append "prescripts"}}
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/flickity/2.2.1/flickity.min.css" integrity="sha256-IKIuKgYQ+ogofw+KAz4fjF+zq7fwoNUnEVts493jKKE=" crossorigin="anonymous" />
  {{#if lightbox}}
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js" defer></script>
  <script type="text/javascript" src="{{rev '/js/post-lightbox.js'}}" defer></script>
  {{/if}}
  {{/append}}

  {{#content "bodyAttributes"}}class="page-post"{{/content}}
  {{#content "body"}}
  <article class="{{#each classes}}{{this}} {{/each}}">
    {{#if title}}<h1 class="post-title"><a href="{{this.url}}">{{title}}</a></h1>{{/if}}
    {{#if subtitle}}<h2 class="post-subtitle"><a href="{{this.url}}">{{subtitle}}</a></h2>{{/if}}
    <div class="post-date"><span>{{date 'MMMM Do, YYYY' this.date}}</span>{{#each tags}}<a href="/#{{@key}}">{{this}}</a>{{/each}}</div>

    {{#unless flags.hideImages}}{{#if flags.singleImage}}
    <div class="post-images">
      {{#each images}}
        {{#compare type 'movie'}}
        <a class="{{#even @index}}even{{else}}odd{{/even}}">
          <video {{#if ../video.controls}}controls{{else}}autoplay muted loop{{/if}}><source src="{{full}}" type="video/mp4"></video>
          {{#if (get ../captions @key)}}<span class="image-caption">{{get ../captions @key}}</span>{{/if}}
        </a>
        {{/compare}}
        {{#compare type 'image'}}
        <a href="{{rev full}}" class="{{#even @index}}even{{else}}odd{{/even}}">
          {{#if ../flags.isWide}}
          <img
            src="{{rev large}}"
            alt="{{alt}}"
            srcset="{{rev thumb}} 100w, {{rev small}} 576w, {{rev large}} 1024w"
            sizes="(max-width: 576px) 100vw, (max-width: 960px) 95vw, 960px"
          >
          {{else}}
          <img
            src="{{rev large}}"
            alt="{{alt}}"
            srcset="{{rev thumb}} 100w, {{rev small}} 576w, {{rev large}} 1024w, {{rev poster.full}} 2048w"
            sizes="(max-width: 576px) 100vw, 576px"
          >
          {{/if}}
          {{#if (get ../captions @key)}}<span class="image-caption">{{get ../captions @key}}</span>{{/if}}
        </a>
        {{/compare}}
      {{/each}}
    </div>
    {{else}}
    <div class="post-carousel">
      <div class="carousel" data-flickity="{{#if carousel}}{{carousel}}{{else}}{}{{/if}}">
      {{#each images}}
        {{#compare type 'movie'}}
        <a class="carousel-cell {{#even @index}}even{{else}}odd{{/even}}">
          <video {{#if video.controls}}controls{{else}}autoplay muted loop{{/if}}><source src="{{full}}" type="video/mp4"></video>
          {{#if (get ../captions @key)}}<span class="image-caption">{{get ../captions @key}}</span>{{/if}}
        </a>
        {{/compare}}
        {{#compare type 'image'}}
        <a href="{{rev full}}" class="carousel-cell {{#even @index}}even{{else}}odd{{/even}}">
          <img
            src="{{rev preview}}"
            alt="{{alt}}"
            srcset="{{rev preview}} 1x, {{rev preview2x}} 2x"
          >
          {{#if (get ../captions @key)}}<span class="image-caption">{{get ../captions @key}}</span>{{/if}}
        </a>
        {{/compare}}
      {{/each}}
      </div>
    </div>
    {{/if}}{{/unless}}

    {{#if products}}
    <ul class="post-products">
      <li class="title"><span class="disclosure">Disclosure: Amazon links are affiliate URLs</span>Products:</li>
      {{#each products}}<li><a href="{{this}}" rel="nofollow">{{@key}}</a></li>{{/each}}
    </ul>
    {{/if}}
    <div class="post-content">
      {{{this.contents}}}
      {{#if instagram}} <a href="{{instagram}}" class="btn btn-large btn-default instagram" target="_blank"><i class="fab fa-instagram"></i> Discuss this post on Instagram</a>{{/if}}
    </div>
  </article>
  {{/content}}

  {{#append 'postscripts'}}
  <script src="//cdnjs.cloudflare.com/ajax/libs/flickity/2.2.1/flickity.pkgd.min.js" integrity="sha256-3Maq7M1TC8sOke8B4gRkhfGtETqGWq+xenQO7k2mHjI=" crossorigin="anonymous" async></script>

  {{#if lazy}}
  <script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.9.0/lozad.min.js"></script>
  <script>
    window.lozad('img[data-src]', {
      rootMargin: '50% 0px', // syntax similar to that of CSS Margin
      threshold: 0.5, // ratio of element convergence
    }).observe(); // lazy loads elements with default selector as '.lozad'
  </script>
  {{/if}}
  {{/append}}

{{/extend}}
